# LifeRPG 成就系统增强 & 白天模式优化

## 🎉 更新概览

本次更新对成就系统进行了全面重构，添加了**成就链**、**系列系统**、**稀有度分级**、**成就点数**等复杂机制，并优化了白天模式的配色方案，使其更加干练专业。

---

## ✨ 成就系统增强

### 1. 成就数量大幅增加

- **原有**: 25 个基础成就
- **现在**: 40+ 个复杂成就
  - 学者系列（Scholar）: 5 个任务相关成就
  - 战士系列（Warrior）: 4 个连击相关成就
  - 守护者系列（Guardian）: 4 个平衡发展成就
  - 探索者系列（Explorer）: 4 个等级相关成就
  - 大师系列（Master）: 8 个单项属性极致成就
  - 传奇系列（Legendary）: 2 个终极组合成就
  - 隐藏成就: 5 个特殊条件成就

### 2. 成就系列系统 (Series)

**6 大成就系列**，每个系列有独特的主题和进阶路线：

| 系列 | 图标 | 颜色 | 描述 | 成就数量 |
|------|------|------|------|----------|
| 🎓 学者系列 | 📖 | 蓝色 | 完成任务积累智慧 | 5 |
| ⚔️ 战士系列 | 🗡️ | 红色 | 连续打卡展现意志 | 4 |
| 🛡️ 守护者系列 | 🛡️ | 绿色 | 平衡发展达成和谐 | 4 |
| 🧭 探索者系列 | 🧭 | 橙色 | 等级提升探索世界 | 4 |
| 🏆 大师系列 | 🏅 | 紫色 | 单项属性达到极致 | 8 |
| 👑 传奇系列 | 👑 | 金色 | 终极挑战组合成就 | 2 |

### 3. 成就链系统 (Achievement Chains)

**前置成就要求 (Prerequisites)**

某些高级成就需要先完成前置成就才能解锁：

```
踏出第一步 (1个任务)
  ↓
学者学徒 I (10个任务)
  ↓
学者行家 II (50个任务)
  ↓
学者大师 III (100个任务)
  ↓
学者宗师 IV (500个任务)
```

**视觉标识**：
- ✅ 已解锁：彩色边框 + 发光效果
- 🔓 可解锁：灰白边框 + 正常透明度
- 🔒 已锁定：深灰边框 + 50% 透明度 + 提示"需要先完成前置成就"

### 4. 进阶成就系统 (Progression)

同一系列的成就分为多个进阶等级（I → II → III → IV）

**特点**：
- 左上角显示进阶等级标记（Lv.1 ~ Lv.4）
- 奖励递增（Bronze → Silver → Gold → Platinum）
- 自动引导玩家完成整条成就链

**示例**：
```
智力大师 I  (INT 50)  → +200 EXP, +100 金币, +15 点数
智力大师 II (INT 100) → +500 EXP, +250 金币, +30 点数, 称号"博学者"
```

### 5. 组合成就 (Combo Requirements)

需要同时满足多个条件才能解锁：

**平衡守护者**：
- 需要先完成：守护者学徒
- 需要同时满足：INT ≥ 25, VIT ≥ 25, MNG ≥ 25, CRE ≥ 25

**终极传奇**：
- 需要先完成：探索传奇 + 完美守护者 + 学者宗师
- 需要同时满足：等级 50 + 所有属性 100 + 完成 500 任务
- 奖励：+5000 EXP, +3000 金币, +100 点数, 称号"至尊"

### 6. 稀有度系统 (Rarity)

成就按稀有度分为 4 个等级：

| 稀有度 | 颜色 | 图标 | 描述 |
|--------|------|------|------|
| 普通 (Common) | 灰色 | 💎 | 基础成就，容易获得 |
| 稀有 (Rare) | 蓝色 | 💎 | 需要一定努力 |
| 史诗 (Epic) | 紫色 | 💎 | 较难完成的成就 |
| 传说 (Legendary) | 橙色 | 💎 | 终极挑战成就 |

**视觉表现**：
- 稀有度徽章显示在成就卡片右上角
- 不同颜色的渐变背景和发光效果

### 7. 成就点数系统 (Achievement Points)

**累积机制**：
- 每个成就解锁后获得对应点数
- Bronze: 5-10 点
- Silver: 15-25 点
- Gold: 30-40 点
- Platinum: 50-60 点
- Diamond: 100 点

**显示位置**：
- 成就页面头部：紫色宝石图标 + 大号数字
- 成就通知：奖励信息中显示"+X 点数"
- 成就卡片：奖励预览中显示点数

**未来用途**：
- 成就点数可用于奖励商店兑换特殊道具
- 解锁特殊称号和外观
- 兑换经验加成和金币加成

---

## 🎨 白天模式优化

### 更新前的问题

- 背景色过于鲜艳 (#f0f4f8)
- 图标颜色饱和度过高
- 整体风格不够专业

### 优化后的配色方案

**背景颜色**：
```css
--bg-color: #fafbfc;  /* 米白色，更柔和 */
--glass-bg: rgba(255, 255, 255, 0.85);  /* 玻璃卡片透明度提升 */
--glass-border: rgba(100, 116, 139, 0.15);  /* 蓝灰色边框 */
```

**文字颜色**：
```css
/* 主文字：深灰色而非纯黑 */
--text-color: #2d3748;

/* 次级文字：降低饱和度的灰色 */
.text-white/60 → rgba(45, 55, 72, 0.7)
.text-white/40 → rgba(100, 116, 139, 0.6)
.text-white/20 → rgba(148, 163, 184, 0.4)
```

**强调色优化**：
```css
/* Cyber 颜色降低饱和度 */
.text-cyber-cyan   → #0284c7 (原: #00f3ff)
.text-cyber-purple → #7c3aed (原: #bc13fe)
.text-cyber-green  → #059669 (原: #00ff00)

/* 图标颜色更加柔和 */
.text-yellow-400 → #d97706 (原: #fbbf24)
.text-purple-400 → #7c3aed (原: #a855f7)
```

**背景透明度**：
```css
/* 原本过于明显的背景 */
.bg-white/5 → rgba(71, 85, 105, 0.08)
.bg-white/10 → rgba(71, 85, 105, 0.12)

/* 遮罩层柔化 */
.bg-black/20 → rgba(255, 255, 255, 0.6)
.bg-black/80 → rgba(255, 255, 255, 0.95)
```

### 视觉效果对比

**黑夜模式**：
- 保持原有的赛博朋克风格
- 高对比度、霓虹色、发光效果
- 适合沉浸式体验

**白天模式**：
- 干净专业的配色
- 柔和的蓝灰色系
- 适合白天工作环境
- 护眼舒适

---

## 📊 成就页面全新设计

### 头部统计区域

**左侧**：
- 标题：成就系统
- 副标题：完成成就链，解锁强大奖励

**右侧双指标**：
1. **成就点数**: 紫色宝石 + 大号数字
2. **解锁进度**: X/40 已解锁

**总进度条**：
- 彩虹渐变（Cyan → Purple → Green）
- 百分比实时计算

**系列统计**：
- 6 个系列的圆形图标
- 每个系列独立进度（X/Y）
- 系列专属颜色

### 成就按系列分组展示

**每个系列独立区块**：
1. 系列图标 + 名称
2. 系列描述 + 完成进度
3. 成就卡片网格（3 列布局）

**成就卡片增强**：

**右上角徽章**：
- 稀有度标记（普通/稀有/史诗/传说）
- 等级标记（Bronze/Silver/Gold/Platinum/Diamond）
- 解锁状态（✓ 或 🔒）

**左上角标记**（仅进阶成就）：
- 链条图标 + Lv.X
- 紫色背景

**卡片内容**：
- 标题 + 描述
- 前置成就提示（未完成时显示橙色警告框）
- 奖励预览（EXP + 金币 + 点数 + 称号）
- 实时进度条

**遮罩效果**：
- 已解锁：彩色边框 + 发光效果
- 可解锁：灰白边框 + 70% 透明度
- 已锁定：深灰边框 + 50% 透明度 + 强遮罩

---

## 🔧 技术实现

### 新增数据结构

**AchievementData 接口扩展**：
```typescript
export interface AchievementData {
  // ... 原有字段
  series?: AchievementSeries;      // 所属系列
  prerequisites?: string[];         // 前置成就ID
  isProgression?: boolean;          // 是否为进阶成就
  progressionLevel?: number;        // 进阶等级
  nextInChain?: string;             // 链式成就的下一个
  rarity?: 'common' | 'rare' | 'epic' | 'legendary';
  comboRequirement?: {
    achievements?: string[];        // 需要同时拥有的成就
    attributes?: { [key: string]: number };  // 需要同时达到的属性
  };
  reward: {
    exp: number;
    coins: number;
    title?: string;
    points?: number;                // 成就点数
  };
}
```

### 成就检查逻辑增强

**checkAchievements() 函数**：
1. ✅ 检查前置成就是否已解锁
2. ✅ 检查组合成就要求
3. ✅ 检查属性组合要求
4. ✅ 智能跳过未满足前置条件的成就
5. ✅ 累积成就点数

**关键代码**：
```typescript
// 检查前置成就
if (achievement.prerequisites && achievement.prerequisites.length > 0) {
  const hasAllPrerequisites = achievement.prerequisites.every(prereqId =>
    state.unlockedAchievements.includes(prereqId)
  );
  if (!hasAllPrerequisites) return; // 跳过
}

// 检查组合要求
if (achievement.comboRequirement) {
  // 检查成就组合
  if (achievement.comboRequirement.achievements) {
    const hasAllAchievements = achievement.comboRequirement.achievements.every(...);
  }

  // 检查属性组合
  if (achievement.comboRequirement.attributes) {
    const meetsAttributeRequirements = Object.entries(...).every(...);
  }
}
```

### 状态管理更新

**新增字段**：
```typescript
export interface GameState {
  achievementPoints: number;  // 成就点数
  // ... 其他字段
}
```

**解锁成就时自动累加点数**：
```typescript
unlockAchievement: (achievementId: string) => {
  // ...
  set((state) => ({
    achievementPoints: state.achievementPoints + (achievement.reward.points || 0),
    // ...
  }));
}
```

---

## 🎯 使用指南

### 查看成就系统

1. 点击左侧导航栏「成就」图标
2. 查看头部统计：
   - 成就点数（紫色）
   - 解锁进度（X/40）
   - 6 个系列的完成情况
3. 滚动浏览各个系列

### 完成成就链

**示例：学者系列**

1. 完成第一个任务 → 解锁"踏出第一步"
2. 完成 10 个任务 → 解锁"学者学徒 I"
3. 完成 50 个任务 → 解锁"学者行家 II"
4. 完成 100 个任务 → 解锁"学者大师 III" + 称号"博学者"
5. 完成 500 个任务 → 解锁"学者宗师 IV" + 称号"智者"

**奖励累积**：
- 经验：50 + 100 + 300 + 500 + 2000 = **2950 EXP**
- 金币：20 + 50 + 150 + 300 + 1000 = **1520 金币**
- 点数：5 + 10 + 20 + 35 + 50 = **120 点数**
- 称号：初心者 → 博学者 → 智者

### 挑战终极成就

**终极传奇（至尊）**：

**前置条件**：
1. 完成"探索传奇"（等级 50）
2. 完成"完美守护者"（所有属性 100）
3. 完成"学者宗师"（完成 500 任务）

**额外要求**：
- 所有属性必须同时保持 ≥ 100
- 等级必须保持 50

**奖励**：
- +5000 EXP
- +3000 金币
- +100 点数
- 称号"至尊"
- Diamond 等级成就

### 切换白天模式

1. 点击右上角太阳/月亮图标
2. 体验更干练的白天配色
3. 所有颜色自动调整为专业配色

---

## 📝 文件清单

### 新增/修改的文件

1. **src/data/achievements.ts** - 成就数据（完全重写）
   - 40+ 个成就定义
   - 6 大系列分类
   - 前置成就链
   - 稀有度和点数

2. **src/components/AchievementsPage.tsx** - 成就页面（完全重写）
   - 按系列分组显示
   - 成就点数统计
   - 前置成就检查
   - 稀有度标记

3. **src/store/gameStore.ts** - 状态管理（增强）
   - 成就点数累积
   - 复杂成就检查逻辑
   - 前置成就验证
   - 组合成就验证

4. **src/types/game.ts** - 类型定义（扩展）
   - achievementPoints 字段
   - 通知中的 points 字段

5. **src/components/AchievementNotification.tsx** - 成就通知（更新）
   - 显示成就点数奖励

6. **src/app/globals.css** - 样式表（优化）
   - 白天模式配色优化
   - 降低饱和度
   - 蓝灰色系

---

## 🚀 测试建议

### 测试成就链

1. **学者系列**：
   - 完成 1 个任务 → "踏出第一步"
   - 完成 10 个任务 → "学者学徒 I"
   - 观察前置成就是否正确解锁

2. **战士系列**：
   - 连续登录 3 天 → "战士新兵 I"
   - 连续登录 7 天 → "战士士兵 II"

3. **守护者系列**：
   - 提升任意属性到 25 → "守护者学徒"
   - 所有属性达到 25 → "平衡守护者"（需要前置成就）

### 测试成就点数

1. 解锁几个成就
2. 查看头部成就点数是否正确累加
3. 查看通知中是否显示点数奖励

### 测试白天模式

1. 切换到白天模式
2. 检查所有页面的配色是否柔和
3. 检查图标颜色是否降低饱和度
4. 检查文字对比度是否合适

---

## 📊 成就完整列表

### 学者系列（5个）

| 成就 | 要求 | 等级 | 稀有度 | 点数 |
|------|------|------|--------|------|
| 踏出第一步 | 1个任务 | Bronze | 普通 | 5 |
| 学者学徒 I | 10个任务 | Bronze | 普通 | 10 |
| 学者行家 II | 50个任务 | Silver | 稀有 | 20 |
| 学者大师 III | 100个任务 | Gold | 史诗 | 35 |
| 学者宗师 IV | 500个任务 | Platinum | 传说 | 50 |

### 战士系列（4个）

| 成就 | 要求 | 等级 | 稀有度 | 点数 |
|------|------|------|--------|------|
| 战士新兵 I | 3天连击 | Bronze | 普通 | 8 |
| 战士士兵 II | 7天连击 | Silver | 稀有 | 15 |
| 战士骑士 III | 30天连击 | Gold | 史诗 | 30 |
| 战士冠军 IV | 100天连击 | Platinum | 传说 | 50 |

### 守护者系列（4个）

| 成就 | 要求 | 等级 | 稀有度 | 点数 |
|------|------|------|--------|------|
| 守护者学徒 | 任意属性25 | Bronze | 普通 | 8 |
| 平衡守护者 | 全属性25 | Silver | 稀有 | 25 |
| 和谐守护者 | 全属性50 | Gold | 史诗 | 40 |
| 完美守护者 | 全属性100 | Platinum | 传说 | 60 |

### 探索者系列（4个）

| 成就 | 要求 | 等级 | 稀有度 | 点数 |
|------|------|------|--------|------|
| 探索新手 | 等级5 | Bronze | 普通 | 10 |
| 探索行家 | 等级10 | Silver | 稀有 | 15 |
| 探索老兵 | 等级20 | Gold | 史诗 | 30 |
| 探索传奇 | 等级50 | Platinum | 传说 | 50 |

### 大师系列（8个）

| 成就 | 要求 | 等级 | 稀有度 | 点数 |
|------|------|------|--------|------|
| 智力大师 I | INT 50 | Silver | 稀有 | 15 |
| 智力大师 II | INT 100 | Gold | 史诗 | 30 |
| 活力大师 I | VIT 50 | Silver | 稀有 | 15 |
| 活力大师 II | VIT 100 | Gold | 史诗 | 30 |
| 管理大师 I | MNG 50 | Silver | 稀有 | 15 |
| 管理大师 II | MNG 100 | Gold | 史诗 | 30 |
| 创意大师 I | CRE 50 | Silver | 稀有 | 15 |
| 创意大师 II | CRE 100 | Gold | 史诗 | 30 |

### 传奇系列（2个）

| 成就 | 要求 | 等级 | 稀有度 | 点数 |
|------|------|------|--------|------|
| 传奇富豪 | 1000金币 | Gold | 史诗 | 25 |
| 终极传奇 | 等级50+全属性100+500任务 | Diamond | 传说 | 100 |

### 隐藏成就（5个）

| 成就 | 要求 | 等级 | 稀有度 | 点数 |
|------|------|------|--------|------|
| 夜猫子 | 凌晨0-5点完成任务 | Silver | 稀有 | 20 |
| 早起的鸟儿 | 早晨5-7点完成任务 | Silver | 稀有 | 20 |
| 完美主义者 | 单日完成10任务 | Gold | 史诗 | 35 |
| 速度恶魔 | 1小时内完成5任务 | Gold | 史诗 | 40 |
| 收藏家 | 解锁20个成就 | Platinum | 传说 | 50 |

**总计**：40 个成就，最高可获得 **805 成就点数**

---

## 🎁 未来扩展

### 成就点数商店（计划中）

使用成就点数兑换：
- 经验加成卡（+50% EXP，持续1小时）
- 金币加成卡（+100% 金币，持续1天）
- 特殊称号（稀有/史诗/传说级称号）
- 主题皮肤（粒子颜色、UI主题）
- 属性重置卷（重新分配属性点）

### 更多成就系列

- 🎭 艺术家系列（创作相关）
- 🔬 科学家系列（探索相关）
- 🎯 猎人系列（挑战相关）
- 🌟 收藏家系列（收集相关）

### 成就排行榜

- 本地多用户对比
- 成就解锁速度统计
- 稀有成就拥有者展示

---

## 📸 视觉预览

### 成就页面

**头部**：
```
╔═══════════════════════════════════════════════════╗
║  成就系统                          💎 125    0/40 ║
║  完成成就链，解锁强大奖励           点数      已解锁║
║                                                   ║
║  总体进度 ▓▓▓░░░░░░░░░░░░░░░░░░ 15%               ║
║                                                   ║
║  🎓    ⚔️    🛡️    🧭    🏆    👑                  ║
║  学者  战士  守护  探索  大师  传奇               ║
║  2/5   1/4   0/4   1/4   0/8   0/2              ║
╚═══════════════════════════════════════════════════╝
```

**成就卡片**：
```
╔═══════════════════════════════════╗
║ Lv.2        【稀有】Bronze ✓      ║
║                                   ║
║ 学者行家 II                       ║
║ 完成 50 个任务，学识渐长          ║
║                                   ║
║ ⚡+300  💰+150  💎+20             ║
║                                   ║
║ 进度 50/50 ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓ 100% ║
╚═══════════════════════════════════╝
```

---

**体验全新的成就系统，挑战终极传奇！** 🚀
