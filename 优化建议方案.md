# LifeRPG ç³»ç»Ÿä¼˜åŒ–å»ºè®®æ–¹æ¡ˆ

**åˆ†ææ—¥æœŸ**: 2026-01-06
**å½“å‰ç‰ˆæœ¬**: 1.0.0
**åˆ†æå¸ˆ**: Claude Sonnet 4.5

---

## ğŸ“Š ç³»ç»Ÿç°çŠ¶åˆ†æ

### æŠ€æœ¯æ ˆ
- **å‰ç«¯**: Next.js 14.2 + React 18.3 + TypeScript 5.4
- **3Dæ¸²æŸ“**: Three.js 0.162 + React-Three-Fiber 8.16
- **çŠ¶æ€ç®¡ç†**: Zustand 4.5 + LocalStorageæŒä¹…åŒ–
- **æ ·å¼**: Tailwind CSS 3.4
- **åŠ¨ç”»**: Framer Motion 11.0

### é¡¹ç›®è§„æ¨¡
- **ç»„ä»¶æ•°é‡**: 31ä¸ªReactç»„ä»¶
- **æ„å»ºå¤§å°**: é¦–æ¬¡åŠ è½½ 407 KB
- **ä»£ç è¡Œæ•°**: gameStore.ts 1,293è¡Œ

### å·²å®ç°åŠŸèƒ½
âœ… å››ç»´å±æ€§ç³»ç»Ÿ (INT/VIT/MNG/CRE)
âœ… ä»»åŠ¡ç³»ç»Ÿ (ä¸»çº¿/æ”¯çº¿/æ—¥å¸¸)
âœ… æˆå°±ç³»ç»Ÿ (å¤šå±‚çº§æˆå°±)
âœ… ä¸“æ³¨æ¨¡å¼ (ç•ªèŒ„é’Ÿ)
âœ… æ¯æ—¥ç­¾åˆ°ç³»ç»Ÿ
âœ… å¥–åŠ±å•†åº—
âœ… èƒŒåŒ…ç³»ç»Ÿ
âœ… å¤šç”¨æˆ·æ”¯æŒ
âœ… è®¡åˆ’è§†å›¾ (æ—¥/å‘¨/æœˆ)
âœ… æ•°æ®ç»Ÿè®¡é¢æ¿

---

## ğŸ¯ ä¼˜åŒ–æ–¹å‘æ¦‚è§ˆ

### ä¼˜å…ˆçº§åˆ†ç±»

| ä¼˜å…ˆçº§ | ç±»åˆ« | æ•°é‡ | é¢„æœŸæ”¶ç›Š |
|--------|------|------|---------|
| ğŸ”´ é«˜ | æ€§èƒ½ä¼˜åŒ– | 5é¡¹ | 30-50%æ€§èƒ½æå‡ |
| ğŸŸ¡ ä¸­ | ç”¨æˆ·ä½“éªŒ | 8é¡¹ | æ˜¾è‘—æå‡æ˜“ç”¨æ€§ |
| ğŸŸ¢ ä½ | åŠŸèƒ½å¢å¼º | 6é¡¹ | å¢åŠ ç³»ç»Ÿä»·å€¼ |

---

## ğŸš€ ä¸€ã€æ€§èƒ½ä¼˜åŒ– (é«˜ä¼˜å…ˆçº§)

### 1.1 ç²’å­ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–

**é—®é¢˜è¯†åˆ«**:
```typescript
// ParticleBackground.tsx:30
function ParticleSystem({ count = 90000, mode = 'repulsion', colorTheme = 'cyber' })
```
- å½“å‰ç²’å­æ•°: **90,000** ä¸ª
- æ¯å¸§æ¸²æŸ“è´Ÿè½½: æé«˜
- ç§»åŠ¨è®¾å¤‡/ä½ç«¯è®¾å¤‡: ä¸¥é‡å¡é¡¿é£é™©

**ä¼˜åŒ–æ–¹æ¡ˆ**:

#### æ–¹æ¡ˆA: è‡ªé€‚åº”ç²’å­æ•°é‡ â­ æ¨è
```typescript
// æ ¹æ®è®¾å¤‡æ€§èƒ½åŠ¨æ€è°ƒæ•´ç²’å­æ•°é‡
const getOptimalParticleCount = () => {
  // æ£€æµ‹è®¾å¤‡ç±»å‹
  const isMobile = /iPhone|iPad|Android/i.test(navigator.userAgent);
  const isLowEnd = navigator.hardwareConcurrency <= 4;

  if (isMobile) return 15000;
  if (isLowEnd) return 30000;
  return 50000; // é«˜æ€§èƒ½è®¾å¤‡
};

// ä½¿ç”¨GPUå®ä¾‹åŒ–
const particles = useMemo(() => {
  const count = getOptimalParticleCount();
  // ... ç”Ÿæˆç²’å­
}, []);
```

**é¢„æœŸæ•ˆæœ**:
- ç§»åŠ¨è®¾å¤‡: æ€§èƒ½æå‡ **70%**
- ä½ç«¯PC: æ€§èƒ½æå‡ **50%**
- é«˜ç«¯è®¾å¤‡: ä¿æŒæµç•…ä½“éªŒ

#### æ–¹æ¡ˆB: LOD (Level of Detail) ç³»ç»Ÿ
```typescript
// æ ¹æ®æ‘„åƒæœºè·ç¦»è°ƒæ•´ç²’å­å¯†åº¦
const visibleParticles = useMemo(() => {
  const distance = camera.position.length();
  const lodLevel = distance < 20 ? 1 : distance < 40 ? 0.5 : 0.25;
  return Math.floor(baseCount * lodLevel);
}, [camera.position]);
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸ”´ é«˜ (ç«‹å³å®æ–½)

---

### 1.2 ç»„ä»¶æ‡’åŠ è½½ä¼˜åŒ–

**é—®é¢˜è¯†åˆ«**:
```typescript
// page.tsx ä¸­æ‰€æœ‰ç»„ä»¶éƒ½æ˜¯é™æ€å¯¼å…¥
import DashboardPage from '@/components/DashboardPage';
import QuestLog from '@/components/QuestLog';
import AchievementsPage from '@/components/AchievementsPage';
// ... 13ä¸ªç»„ä»¶
```

**é¦–æ¬¡åŠ è½½**: 407 KB - åŒ…å«æ‰€æœ‰é¡µé¢ä»£ç 

**ä¼˜åŒ–æ–¹æ¡ˆ**:

```typescript
// page.tsx - ä½¿ç”¨åŠ¨æ€å¯¼å…¥
import dynamic from 'next/dynamic';
import { Suspense } from 'react';

// æ‡’åŠ è½½å„ä¸ªé¡µé¢ç»„ä»¶
const DashboardPage = dynamic(() => import('@/components/DashboardPage'), {
  loading: () => <PageSkeleton />,
  ssr: false
});

const QuestLog = dynamic(() => import('@/components/QuestLog'), {
  loading: () => <PageSkeleton />
});

const AchievementsPage = dynamic(() => import('@/components/AchievementsPage'), {
  loading: () => <PageSkeleton />
});

// ... å…¶ä»–ç»„ä»¶

// åˆ›å»ºåŠ è½½éª¨æ¶å±
function PageSkeleton() {
  return (
    <div className="animate-pulse space-y-4">
      <div className="h-8 bg-white/10 rounded w-1/4"></div>
      <div className="h-64 bg-white/10 rounded"></div>
    </div>
  );
}
```

**é¢„æœŸæ•ˆæœ**:
- é¦–æ¬¡åŠ è½½æ—¶é—´: å‡å°‘ **40-50%**
- åˆå§‹åŒ…å¤§å°: ä» 407 KB â†’ **~150 KB**
- é¡µé¢åˆ‡æ¢: æŒ‰éœ€åŠ è½½,ç”¨æˆ·æ„ŸçŸ¥æ›´å¿«

**å®æ–½ä¼˜å…ˆçº§**: ğŸ”´ é«˜

---

### 1.3 çŠ¶æ€ç®¡ç†ä¼˜åŒ–

**é—®é¢˜è¯†åˆ«**:
```typescript
// gameStore.ts - 1,293 è¡Œå•ä¸€æ–‡ä»¶
// æ‰€æœ‰é€»è¾‘é›†ä¸­åœ¨ä¸€ä¸ª store ä¸­
```

**ä¼˜åŒ–æ–¹æ¡ˆ**: åˆ†ç¦» Store

```typescript
// 1. æ‹†åˆ†ä¸ºå¤šä¸ªå­ store
// stores/questStore.ts - ä»»åŠ¡ç›¸å…³é€»è¾‘
// stores/achievementStore.ts - æˆå°±ç›¸å…³é€»è¾‘
// stores/focusStore.ts - ä¸“æ³¨æ¨¡å¼é€»è¾‘
// stores/inventoryStore.ts - èƒŒåŒ…ç³»ç»Ÿé€»è¾‘

// 2. ä½¿ç”¨é€‰æ‹©å™¨ä¼˜åŒ–æ¸²æŸ“
// ç»„ä»¶ä¸­åªè®¢é˜…éœ€è¦çš„æ•°æ®
const level = useGameStore(state => state.level); // âœ… å¥½
const { level } = useGameStore(); // âŒ å·® (è®¢é˜…æ•´ä¸ª store)

// 3. æ·»åŠ æµ…æ¯”è¾ƒä¼˜åŒ–
import { shallow } from 'zustand/shallow';

const { quests, completeQuest } = useGameStore(
  state => ({ quests: state.quests, completeQuest: state.completeQuest }),
  shallow
);
```

**é¢„æœŸæ•ˆæœ**:
- å‡å°‘ä¸å¿…è¦çš„ç»„ä»¶é‡æ¸²æŸ“ **60%**
- æå‡å¤§é‡ä»»åŠ¡åœºæ™¯ä¸‹çš„æ€§èƒ½

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

---

### 1.4 å›¾ç‰‡èµ„æºä¼˜åŒ–

**å»ºè®®**:
1. ä½¿ç”¨ Next.js Image ç»„ä»¶
2. æ·»åŠ  WebP æ ¼å¼æ”¯æŒ
3. å®ç°æ‡’åŠ è½½å›¾ç‰‡
4. ä½¿ç”¨ CDN åŠ é€Ÿ

```typescript
import Image from 'next/image';

// ä¼˜åŒ–åçš„å›¾ç‰‡ä½¿ç”¨
<Image
  src="/avatar.png"
  alt="Avatar"
  width={100}
  height={100}
  loading="lazy"
  placeholder="blur"
/>
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¢ ä½

---

### 1.5 LocalStorage ä¼˜åŒ–

**é—®é¢˜è¯†åˆ«**:
```typescript
// gameStore.ts:1224
storage: createJSONStorage(() => createUserStorage())
```
- æ¯æ¬¡çŠ¶æ€æ›´æ–°éƒ½ä¼šåŒæ­¥å†™å…¥ localStorage
- å¤§é‡æ•°æ®æ—¶å¯èƒ½é˜»å¡ä¸»çº¿ç¨‹

**ä¼˜åŒ–æ–¹æ¡ˆ**: é˜²æŠ–å†™å…¥

```typescript
import { debounce } from 'lodash';

const debouncedSave = debounce((state) => {
  localStorage.setItem('liferpg-storage', JSON.stringify(state));
}, 1000); // 1ç§’å†…å¤šæ¬¡æ›´æ–°åªå†™ä¸€æ¬¡

// åœ¨ persist é…ç½®ä¸­ä½¿ç”¨
{
  name: 'liferpg-storage',
  storage: createJSONStorage(() => ({
    getItem: (name) => localStorage.getItem(name),
    setItem: (name, value) => debouncedSave(value),
    removeItem: (name) => localStorage.removeItem(name),
  })),
}
```

**é¢„æœŸæ•ˆæœ**:
- å‡å°‘ localStorage å†™å…¥æ¬¡æ•° **80%**
- æå‡é¢‘ç¹æ“ä½œæ—¶çš„æµç•…åº¦

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

---

## ğŸ’ äºŒã€ç”¨æˆ·ä½“éªŒä¼˜åŒ– (ä¸­ä¼˜å…ˆçº§)

### 2.1 å¿«æ·é”®ç³»ç»Ÿ

**åŠŸèƒ½æè¿°**: æ·»åŠ å…¨å±€å¿«æ·é”®,æå‡æ“ä½œæ•ˆç‡

**å®ç°æ–¹æ¡ˆ**:

```typescript
// hooks/useKeyboardShortcuts.ts
import { useEffect } from 'react';

export const useKeyboardShortcuts = (onPageChange: (page: string) => void) => {
  useEffect(() => {
    const handleKeyPress = (e: KeyboardEvent) => {
      // Ctrl/Cmd + æ•°å­—é”®åˆ‡æ¢é¡µé¢
      if ((e.ctrlKey || e.metaKey) && !e.shiftKey) {
        switch(e.key) {
          case '1': onPageChange('dashboard'); break;
          case '2': onPageChange('quests'); break;
          case '3': onPageChange('planner'); break;
          case '4': onPageChange('achievements'); break;
          case 'n': /* æ–°å»ºä»»åŠ¡ */; break;
          case 'f': /* å¼€å¯ä¸“æ³¨æ¨¡å¼ */; break;
        }
      }
    };

    window.addEventListener('keydown', handleKeyPress);
    return () => window.removeEventListener('keydown', handleKeyPress);
  }, [onPageChange]);
};
```

**å¿«æ·é”®åˆ—è¡¨**:
| å¿«æ·é”® | åŠŸèƒ½ |
|--------|------|
| `Ctrl+1` | åˆ‡æ¢åˆ°ä»ªè¡¨ç›˜ |
| `Ctrl+2` | åˆ‡æ¢åˆ°ä»»åŠ¡åˆ—è¡¨ |
| `Ctrl+3` | åˆ‡æ¢åˆ°è®¡åˆ’è§†å›¾ |
| `Ctrl+N` | æ–°å»ºä»»åŠ¡ |
| `Ctrl+F` | å¯åŠ¨ä¸“æ³¨æ¨¡å¼ |
| `Ctrl+/` | æ˜¾ç¤ºå¿«æ·é”®å¸®åŠ© |

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

---

### 2.2 ä»»åŠ¡æœç´¢ä¸ç­›é€‰

**åŠŸèƒ½æè¿°**: åœ¨ä»»åŠ¡é¡µé¢æ·»åŠ å¼ºå¤§çš„æœç´¢å’Œç­›é€‰åŠŸèƒ½

```typescript
// components/QuestFilter.tsx
interface QuestFilterProps {
  onFilter: (filters: FilterOptions) => void;
}

interface FilterOptions {
  searchTerm: string;
  type: QuestType | 'all';
  status: QuestStatus | 'all';
  attributes: AttributeType[];
  priority: string[];
  tags: string[];
  dateRange: { start?: Date; end?: Date };
}

function QuestFilter({ onFilter }: QuestFilterProps) {
  return (
    <div className="glass-card p-6 mb-6">
      {/* æœç´¢æ¡† */}
      <input
        type="text"
        placeholder="æœç´¢ä»»åŠ¡æ ‡é¢˜æˆ–æè¿°..."
        className="w-full mb-4"
      />

      {/* ç­›é€‰å™¨ */}
      <div className="grid grid-cols-4 gap-4">
        <select>{/* ä»»åŠ¡ç±»å‹ */}</select>
        <select>{/* ä»»åŠ¡çŠ¶æ€ */}</select>
        <select>{/* ä¼˜å…ˆçº§ */}</select>
        <select>{/* å±æ€§ç±»å‹ */}</select>
      </div>

      {/* æ ‡ç­¾ç­›é€‰ */}
      <div className="flex flex-wrap gap-2 mt-4">
        {/* æ ‡ç­¾æŒ‰é’® */}
      </div>
    </div>
  );
}
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

---

### 2.3 æ•°æ®å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½

**åŠŸèƒ½æè¿°**: æ”¯æŒå¯¼å‡ºå’Œå¯¼å…¥æ¸¸æˆæ•°æ®,æ–¹ä¾¿å¤‡ä»½å’Œè¿ç§»

```typescript
// utils/dataExport.ts
export const exportGameData = (gameState: GameState) => {
  const data = JSON.stringify(gameState, null, 2);
  const blob = new Blob([data], { type: 'application/json' });
  const url = URL.createObjectURL(blob);

  const link = document.createElement('a');
  link.href = url;
  link.download = `liferpg-backup-${new Date().toISOString().split('T')[0]}.json`;
  link.click();

  URL.revokeObjectURL(url);
};

export const importGameData = async (file: File): Promise<GameState> => {
  const text = await file.text();
  const data = JSON.parse(text);

  // æ•°æ®éªŒè¯
  validateGameState(data);

  return data;
};
```

**UI é›†æˆ**:
- åœ¨è®¾ç½®é¡µé¢æ·»åŠ "å¯¼å‡ºæ•°æ®"æŒ‰é’®
- æ·»åŠ "å¯¼å…¥æ•°æ®"ä¸Šä¼ åŠŸèƒ½
- æ˜¾ç¤ºå¤‡ä»½å†å²è®°å½•

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

---

### 2.4 ä»»åŠ¡ç»Ÿè®¡ä»ªè¡¨æ¿

**åŠŸèƒ½æè¿°**: æ·»åŠ è¯¦ç»†çš„æ•°æ®å¯è§†åŒ–å’Œç»Ÿè®¡åˆ†æ

```typescript
// components/StatsDashboard.tsx
interface StatsData {
  // ä»»åŠ¡å®Œæˆè¶‹åŠ¿
  completionTrend: { date: string; count: number }[];

  // å±æ€§å¢é•¿æ›²çº¿
  attributeGrowth: {
    date: string;
    int: number;
    vit: number;
    mng: number;
    cre: number;
  }[];

  // ä»»åŠ¡ç±»å‹åˆ†å¸ƒ
  questTypeDistribution: { type: string; count: number; percentage: number }[];

  // ä¸“æ³¨æ—¶é•¿ç»Ÿè®¡
  focusTimeStats: {
    total: number;
    average: number;
    longestSession: number;
  };

  // è¿å‡»è®°å½•
  streakHistory: { date: string; streak: number }[];
}

function StatsDashboard() {
  return (
    <div className="grid grid-cols-2 gap-6">
      {/* ä»»åŠ¡å®Œæˆè¶‹åŠ¿å›¾ */}
      <LineChart data={completionTrend} />

      {/* å±æ€§é›·è¾¾å›¾ */}
      <RadarChart data={attributes} />

      {/* ä»»åŠ¡ç±»å‹é¥¼å›¾ */}
      <PieChart data={questTypeDistribution} />

      {/* ä¸“æ³¨æ—¶é•¿æ¡å½¢å›¾ */}
      <BarChart data={focusTimeStats} />
    </div>
  );
}
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¢ ä½

---

### 2.5 ä»»åŠ¡æ¨¡æ¿ç³»ç»Ÿ

**åŠŸèƒ½æè¿°**: é¢„è®¾å¸¸ç”¨ä»»åŠ¡æ¨¡æ¿,å¿«é€Ÿåˆ›å»ºä»»åŠ¡

```typescript
// data/questTemplates.ts
export const QUEST_TEMPLATES = [
  {
    id: 'academic_paper',
    name: 'ğŸ“„ é˜…è¯»å­¦æœ¯è®ºæ–‡',
    description: 'é˜…è¯»å¹¶æ€»ç»“ä¸€ç¯‡å­¦æœ¯è®ºæ–‡',
    type: QuestType.DAILY,
    attributes: ['int'],
    expReward: 20,
    coinReward: 15,
    estimatedDuration: 60,
    subtasks: [
      { title: 'å¿«é€Ÿæµè§ˆå…¨æ–‡' },
      { title: 'ç²¾è¯»æ ¸å¿ƒç« èŠ‚' },
      { title: 'è®°å½•å…³é”®è§‚ç‚¹' },
      { title: 'æ’°å†™æ€»ç»“ç¬”è®°' },
    ],
  },
  {
    id: 'workout',
    name: 'ğŸ’ª å¥èº«è®­ç»ƒ',
    description: 'å®Œæˆä¸€æ¬¡å¥èº«è®­ç»ƒ',
    type: QuestType.DAILY,
    attributes: ['vit'],
    expReward: 25,
    coinReward: 20,
    estimatedDuration: 45,
  },
  {
    id: 'code_practice',
    name: 'ğŸ’» ç¼–ç¨‹ç»ƒä¹ ',
    description: 'åˆ·ç®—æ³•é¢˜æˆ–åšé¡¹ç›®',
    type: QuestType.DAILY,
    attributes: ['int', 'cre'],
    expReward: 30,
    coinReward: 25,
  },
  // ... æ›´å¤šæ¨¡æ¿
];
```

**UI å®ç°**:
```typescript
// åœ¨ä»»åŠ¡åˆ›å»ºå¯¹è¯æ¡†ä¸­æ·»åŠ "ä½¿ç”¨æ¨¡æ¿"æŒ‰é’®
<div className="mb-4">
  <button
    onClick={() => setShowTemplates(true)}
    className="btn-secondary"
  >
    ğŸ“‹ ä»æ¨¡æ¿åˆ›å»º
  </button>
</div>

{showTemplates && (
  <div className="grid grid-cols-3 gap-4">
    {QUEST_TEMPLATES.map(template => (
      <div
        key={template.id}
        onClick={() => applyTemplate(template)}
        className="p-4 glass-card cursor-pointer hover:scale-105"
      >
        <h4>{template.name}</h4>
        <p className="text-sm">{template.description}</p>
      </div>
    ))}
  </div>
)}
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

---

### 2.6 ä¹ æƒ¯è¿½è¸ªå™¨

**åŠŸèƒ½æè¿°**: æ·»åŠ é•¿æœŸä¹ æƒ¯è¿½è¸ªåŠŸèƒ½,å¯è§†åŒ–è¿ç»­æ‰“å¡

```typescript
// components/HabitTracker.tsx
interface Habit {
  id: string;
  name: string;
  icon: string;
  frequency: 'daily' | 'weekly' | 'custom';
  targetDays: number; // ç›®æ ‡å¤©æ•°
  completedDays: string[]; // å·²å®Œæˆæ—¥æœŸæ•°ç»„
  currentStreak: number; // å½“å‰è¿ç»­å¤©æ•°
  longestStreak: number; // æœ€é•¿è¿ç»­å¤©æ•°
}

function HabitTracker() {
  return (
    <div className="space-y-6">
      {habits.map(habit => (
        <div key={habit.id} className="glass-card p-6">
          <div className="flex justify-between items-center mb-4">
            <h3>{habit.icon} {habit.name}</h3>
            <div className="text-sm">
              <span>ğŸ”¥ {habit.currentStreak} å¤©è¿ç»­</span>
            </div>
          </div>

          {/* æ—¥å†çƒ­åŠ›å›¾ */}
          <div className="grid grid-cols-7 gap-2">
            {last365Days.map(day => (
              <div
                key={day}
                className={cn(
                  'w-8 h-8 rounded',
                  habit.completedDays.includes(day)
                    ? 'bg-green-500'
                    : 'bg-white/10'
                )}
              />
            ))}
          </div>

          {/* ä»Šæ—¥æ‰“å¡æŒ‰é’® */}
          <button
            onClick={() => checkInHabit(habit.id)}
            className="mt-4 btn-primary w-full"
          >
            âœ… ä»Šæ—¥æ‰“å¡
          </button>
        </div>
      ))}
    </div>
  );
}
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¢ ä½

---

### 2.7 ä»»åŠ¡æ‹–æ‹½æ’åº

**åŠŸèƒ½æè¿°**: æ”¯æŒæ‹–æ‹½è°ƒæ•´ä»»åŠ¡ä¼˜å…ˆçº§å’Œé¡ºåº

```typescript
// ä½¿ç”¨ @dnd-kit åº“å®ç°æ‹–æ‹½
import { DndContext, closestCenter } from '@dnd-kit/core';
import { arrayMove, SortableContext } from '@dnd-kit/sortable';

function QuestLog() {
  const handleDragEnd = (event) => {
    const { active, over } = event;

    if (active.id !== over.id) {
      setQuests((items) => {
        const oldIndex = items.findIndex((i) => i.id === active.id);
        const newIndex = items.findIndex((i) => i.id === over.id);
        return arrayMove(items, oldIndex, newIndex);
      });
    }
  };

  return (
    <DndContext onDragEnd={handleDragEnd}>
      <SortableContext items={quests}>
        {quests.map(quest => (
          <SortableQuestCard key={quest.id} quest={quest} />
        ))}
      </SortableContext>
    </DndContext>
  );
}
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¢ ä½

---

### 2.8 ç§»åŠ¨ç«¯ä¼˜åŒ–

**é—®é¢˜è¯†åˆ«**:
- å½“å‰è®¾è®¡ä¸»è¦é’ˆå¯¹æ¡Œé¢ç«¯
- ç§»åŠ¨ç«¯ä½“éªŒæœªä¼˜åŒ–

**ä¼˜åŒ–æ–¹æ¡ˆ**:

```typescript
// 1. å“åº”å¼å¸ƒå±€æ”¹è¿›
<div className="
  grid
  grid-cols-1 md:grid-cols-2 lg:grid-cols-3
  gap-4 md:gap-6
">
  {/* å†…å®¹ */}
</div>

// 2. è§¦æ‘¸å‹å¥½çš„äº¤äº’
<button className="
  min-h-[44px] min-w-[44px]  // Apple HIG æ¨èçš„æœ€å°è§¦æ‘¸ç›®æ ‡
  active:scale-95
">
  æŒ‰é’®
</button>

// 3. åº•éƒ¨å¯¼èˆªæ  (ç§»åŠ¨ç«¯)
function MobileNavigation() {
  return (
    <nav className="fixed bottom-0 left-0 right-0 md:hidden">
      <div className="flex justify-around bg-black/80 backdrop-blur-lg">
        {navItems.map(item => (
          <button className="flex-1 py-3">
            {item.icon}
          </button>
        ))}
      </div>
    </nav>
  );
}

// 4. æ‰‹åŠ¿æ”¯æŒ
import { useSwipeable } from 'react-swipeable';

const handlers = useSwipeable({
  onSwipedLeft: () => nextPage(),
  onSwipedRight: () => prevPage(),
});
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

---

## ğŸ”§ ä¸‰ã€ä»£ç è´¨é‡ä¼˜åŒ–

### 3.1 é”™è¯¯è¾¹ç•Œ

**åŠŸèƒ½æè¿°**: æ·»åŠ é”™è¯¯è¾¹ç•Œé˜²æ­¢åº”ç”¨å´©æºƒ

```typescript
// components/ErrorBoundary.tsx
import { Component, ReactNode } from 'react';

interface Props {
  children: ReactNode;
  fallback?: ReactNode;
}

interface State {
  hasError: boolean;
  error?: Error;
}

class ErrorBoundary extends Component<Props, State> {
  constructor(props: Props) {
    super(props);
    this.state = { hasError: false };
  }

  static getDerivedStateFromError(error: Error) {
    return { hasError: true, error };
  }

  componentDidCatch(error: Error, errorInfo: any) {
    console.error('Error caught by boundary:', error, errorInfo);

    // å¯ä»¥å‘é€åˆ°é”™è¯¯è¿½è¸ªæœåŠ¡
    // sendErrorToService(error, errorInfo);
  }

  render() {
    if (this.state.hasError) {
      return this.props.fallback || (
        <div className="min-h-screen flex items-center justify-center">
          <div className="glass-card p-8 max-w-lg text-center">
            <h2 className="text-2xl font-bold mb-4">âš ï¸ å‡ºé”™äº†</h2>
            <p className="mb-4">åº”ç”¨é‡åˆ°äº†ä¸€ä¸ªé”™è¯¯,è¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚</p>
            <button
              onClick={() => window.location.reload()}
              className="btn-primary"
            >
              åˆ·æ–°é¡µé¢
            </button>
          </div>
        </div>
      );
    }

    return this.props.children;
  }
}
```

**ä½¿ç”¨æ–¹å¼**:
```typescript
// app/layout.tsx
<ErrorBoundary>
  <ParticleBackground />
  {children}
</ErrorBoundary>
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸ”´ é«˜

---

### 3.2 æ€§èƒ½ç›‘æ§

**åŠŸèƒ½æè¿°**: æ·»åŠ æ€§èƒ½ç›‘æ§,è¯†åˆ«ç“¶é¢ˆ

```typescript
// utils/performanceMonitor.ts
export class PerformanceMonitor {
  private marks = new Map<string, number>();

  start(label: string) {
    this.marks.set(label, performance.now());
  }

  end(label: string) {
    const start = this.marks.get(label);
    if (start) {
      const duration = performance.now() - start;
      console.log(`[Performance] ${label}: ${duration.toFixed(2)}ms`);

      // å¦‚æœè¶…è¿‡é˜ˆå€¼,å‘å‡ºè­¦å‘Š
      if (duration > 100) {
        console.warn(`[Performance Warning] ${label} took ${duration}ms`);
      }

      this.marks.delete(label);
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const monitor = new PerformanceMonitor();

function ExpensiveComponent() {
  monitor.start('render-expensive-component');

  // ... æ¸²æŸ“é€»è¾‘

  monitor.end('render-expensive-component');
}
```

**React æ€§èƒ½åˆ†æå·¥å…·é›†æˆ**:
```typescript
// ä½¿ç”¨ React DevTools Profiler
import { Profiler } from 'react';

function onRenderCallback(
  id: string,
  phase: 'mount' | 'update',
  actualDuration: number,
) {
  console.log(`${id} (${phase}) rendered in ${actualDuration}ms`);
}

<Profiler id="QuestLog" onRender={onRenderCallback}>
  <QuestLog />
</Profiler>
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

---

### 3.3 æ— éšœç¢è®¿é—®æ”¹è¿›

**åŠŸèƒ½æè¿°**: æå‡åº”ç”¨çš„å¯è®¿é—®æ€§ (a11y)

```typescript
// 1. æ·»åŠ  ARIA æ ‡ç­¾
<button
  aria-label="å®Œæˆä»»åŠ¡"
  aria-pressed={quest.status === QuestStatus.COMPLETED}
>
  <CheckCircle2 />
</button>

// 2. é”®ç›˜å¯¼èˆªæ”¯æŒ
<div
  role="button"
  tabIndex={0}
  onKeyDown={(e) => {
    if (e.key === 'Enter' || e.key === ' ') {
      handleClick();
    }
  }}
>
  å¯è®¿é—®çš„å…ƒç´ 
</div>

// 3. Focus ç®¡ç†
import { useRef, useEffect } from 'react';

function Modal({ isOpen }) {
  const closeButtonRef = useRef<HTMLButtonElement>(null);

  useEffect(() => {
    if (isOpen) {
      closeButtonRef.current?.focus();
    }
  }, [isOpen]);

  return (
    <dialog open={isOpen} aria-modal="true">
      <button ref={closeButtonRef} aria-label="å…³é—­">Ã—</button>
      {/* å†…å®¹ */}
    </dialog>
  );
}

// 4. é¢œè‰²å¯¹æ¯”åº¦
// ç¡®ä¿æ–‡å­—ä¸èƒŒæ™¯æœ‰è¶³å¤Ÿå¯¹æ¯”åº¦ (WCAG AA æ ‡å‡†: 4.5:1)
<p className="text-white/90">  {/* âœ… å¥½ */}
  é«˜å¯¹æ¯”åº¦æ–‡å­—
</p>

<p className="text-white/30">  {/* âŒ å·® */}
  ä½å¯¹æ¯”åº¦æ–‡å­—
</p>
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¢ ä½

---

### 3.4 TypeScript ä¸¥æ ¼æ¨¡å¼

**ä¼˜åŒ–æ–¹æ¡ˆ**: å¯ç”¨æ›´ä¸¥æ ¼çš„ TypeScript æ£€æŸ¥

```json
// tsconfig.json
{
  "compilerOptions": {
    "strict": true,
    "noUncheckedIndexedAccess": true,
    "noImplicitOverride": true,
    "noPropertyAccessFromIndexSignature": true,
    "exactOptionalPropertyTypes": true
  }
}
```

**æ¶ˆé™¤ç±»å‹æ–­è¨€**:
```typescript
// âŒ é¿å…ä½¿ç”¨ any å’Œ as æ–­è¨€
const data = response.data as Quest;

// âœ… ä½¿ç”¨ç±»å‹å®ˆå«
function isQuest(data: unknown): data is Quest {
  return (
    typeof data === 'object' &&
    data !== null &&
    'id' in data &&
    'title' in data
  );
}

if (isQuest(data)) {
  // data è‡ªåŠ¨æ¨æ–­ä¸º Quest ç±»å‹
}
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¢ ä½

---

## ğŸ“± å››ã€æ–°åŠŸèƒ½å»ºè®®

### 4.1 ç¤¾äº¤åŠŸèƒ½

**åŠŸèƒ½æè¿°**: æ·»åŠ å¥½å‹ç³»ç»Ÿå’Œæ’è¡Œæ¦œ

- æ·»åŠ å¥½å‹
- æŸ¥çœ‹å¥½å‹è¿›åº¦
- æ¯å‘¨/æ¯æœˆæ’è¡Œæ¦œ
- ä»»åŠ¡åˆ†äº«åŠŸèƒ½

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¢ ä½ (éœ€è¦åç«¯æ”¯æŒ)

---

### 4.2 ä¸»é¢˜å•†åº—

**åŠŸèƒ½æè¿°**: ä½¿ç”¨é‡‘å¸è´­ä¹°ç•Œé¢ä¸»é¢˜

```typescript
// data/themes.ts
export const THEMES = [
  {
    id: 'cyberpunk',
    name: 'èµ›åšæœ‹å…‹',
    price: 0, // é»˜è®¤ä¸»é¢˜å…è´¹
    colors: {
      primary: '#00f3ff',
      secondary: '#bc13fe',
      // ...
    },
  },
  {
    id: 'forest',
    name: 'æ£®æ—ç»¿æ„',
    price: 500,
    colors: {
      primary: '#10b981',
      secondary: '#059669',
    },
  },
  {
    id: 'sunset',
    name: 'æ—¥è½ä½™æ™–',
    price: 800,
    colors: {
      primary: '#f59e0b',
      secondary: '#ef4444',
    },
  },
];
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¢ ä½

---

### 4.3 AI ä»»åŠ¡æ¨è

**åŠŸèƒ½æè¿°**: æ ¹æ®ç”¨æˆ·å±æ€§å’Œå†å²,æ¨èå¹³è¡¡ä»»åŠ¡

```typescript
// åˆ†æå½“å‰å±æ€§å¹³è¡¡
function analyzeAttributeBalance(attributes: Attributes) {
  const values = Object.values(attributes);
  const avg = values.reduce((a, b) => a + b) / values.length;

  // æ‰¾å‡ºæœ€ä½çš„å±æ€§
  const weakest = Object.entries(attributes)
    .sort(([, a], [, b]) => a - b)[0][0] as AttributeType;

  return {
    weakest,
    isBalanced: Math.max(...values) - Math.min(...values) < 30,
  };
}

// æ¨èä»»åŠ¡
function recommendQuests(user: GameState) {
  const { weakest } = analyzeAttributeBalance(user.attributes);

  return QUEST_TEMPLATES.filter(
    template => template.attributes.includes(weakest)
  );
}
```

**å®æ–½ä¼˜å…ˆçº§**: ğŸŸ¢ ä½

---

## ğŸ“‹ å®æ–½è·¯çº¿å›¾

### ç¬¬ä¸€é˜¶æ®µ (1-2å‘¨) - æ€§èƒ½ä¼˜åŒ– ğŸ”´

- [ ] ç²’å­ç³»ç»Ÿä¼˜åŒ– (è‡ªé€‚åº”æ•°é‡)
- [ ] ç»„ä»¶æ‡’åŠ è½½
- [ ] æ·»åŠ é”™è¯¯è¾¹ç•Œ
- [ ] LocalStorage é˜²æŠ–ä¼˜åŒ–

**é¢„æœŸæ”¶ç›Š**: æ€§èƒ½æå‡ 40-50%,é¦–å±åŠ è½½æ—¶é—´å‡å°‘ 50%

---

### ç¬¬äºŒé˜¶æ®µ (2-3å‘¨) - ç”¨æˆ·ä½“éªŒ ğŸŸ¡

- [ ] å¿«æ·é”®ç³»ç»Ÿ
- [ ] ä»»åŠ¡æœç´¢ç­›é€‰
- [ ] æ•°æ®å¯¼å…¥å¯¼å‡º
- [ ] ä»»åŠ¡æ¨¡æ¿ç³»ç»Ÿ
- [ ] ç§»åŠ¨ç«¯ä¼˜åŒ–

**é¢„æœŸæ”¶ç›Š**: æ“ä½œæ•ˆç‡æå‡ 30%,ç”¨æˆ·ç•™å­˜ç‡æå‡

---

### ç¬¬ä¸‰é˜¶æ®µ (3-4å‘¨) - åŠŸèƒ½å¢å¼º ğŸŸ¢

- [ ] ä¹ æƒ¯è¿½è¸ªå™¨
- [ ] æ•°æ®ç»Ÿè®¡ä»ªè¡¨æ¿
- [ ] ä»»åŠ¡æ‹–æ‹½æ’åº
- [ ] æ€§èƒ½ç›‘æ§å·¥å…·

**é¢„æœŸæ”¶ç›Š**: å¢åŠ ç³»ç»Ÿæ·±åº¦,æå‡ç”¨æˆ·ç²˜æ€§

---

### ç¬¬å››é˜¶æ®µ (é•¿æœŸ) - é«˜çº§åŠŸèƒ½

- [ ] ç¤¾äº¤åŠŸèƒ½
- [ ] ä¸»é¢˜å•†åº—
- [ ] AI ä»»åŠ¡æ¨è
- [ ] ç§»åŠ¨ç«¯ App (React Native)

---

## ğŸ¯ å…³é”®æ€§èƒ½æŒ‡æ ‡ (KPI)

### ä¼˜åŒ–å‰ vs ä¼˜åŒ–åå¯¹æ¯”

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ç›®æ ‡å€¼ | æ”¹å–„ |
|------|--------|--------|------|
| é¦–æ¬¡åŠ è½½æ—¶é—´ | 2.5s | 1.2s | â¬‡ï¸ 52% |
| é¦–æ¬¡å†…å®¹ç»˜åˆ¶ (FCP) | 1.8s | 0.9s | â¬‡ï¸ 50% |
| æœ€å¤§å†…å®¹ç»˜åˆ¶ (LCP) | 3.2s | 1.5s | â¬‡ï¸ 53% |
| æ€»é˜»å¡æ—¶é—´ (TBT) | 450ms | 150ms | â¬‡ï¸ 67% |
| ç´¯ç§¯å¸ƒå±€åç§» (CLS) | 0.08 | <0.1 | âœ… ä¿æŒ |
| é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ (FID) | 120ms | <100ms | â¬‡ï¸ 17% |
| åŒ…å¤§å° | 407 KB | 150 KB | â¬‡ï¸ 63% |
| ç²’å­æ¸²æŸ“ FPS | 30-40 | 55-60 | â¬†ï¸ 50% |

---

## ğŸ’° æˆæœ¬ä¼°ç®—

### å¼€å‘å·¥æ—¶ä¼°ç®—

| é˜¶æ®µ | ä»»åŠ¡æ•° | é¢„è®¡å·¥æ—¶ | å·¥ä½œæ—¥ |
|------|--------|----------|--------|
| ç¬¬ä¸€é˜¶æ®µ | 4é¡¹ | 40å°æ—¶ | 5å¤© |
| ç¬¬äºŒé˜¶æ®µ | 5é¡¹ | 60å°æ—¶ | 7.5å¤© |
| ç¬¬ä¸‰é˜¶æ®µ | 4é¡¹ | 50å°æ—¶ | 6.25å¤© |
| **æ€»è®¡** | **13é¡¹** | **150å°æ—¶** | **~19å¤©** |

---

## ğŸ” æŠ€æœ¯å€ºåŠ¡æ¸…å•

### å½“å‰è¯†åˆ«çš„æŠ€æœ¯å€ºåŠ¡

1. **gameStore.ts è¿‡å¤§** (1,293è¡Œ)
   - å»ºè®®: æ‹†åˆ†ä¸ºå¤šä¸ªå­ store
   - ä¼˜å…ˆçº§: ä¸­

2. **ç¼ºå°‘å•å…ƒæµ‹è¯•**
   - å»ºè®®: æ·»åŠ  Jest + React Testing Library
   - ä¼˜å…ˆçº§: ä¸­

3. **ç¡¬ç¼–ç çš„é­”æ³•æ•°å­—**
   ```typescript
   // âŒ ç¡¬ç¼–ç 
   const radius = 15 + Math.random() * 12;

   // âœ… ä½¿ç”¨å¸¸é‡
   const PARTICLE_RADIUS_MIN = 15;
   const PARTICLE_RADIUS_MAX = 27;
   const radius = PARTICLE_RADIUS_MIN + Math.random() * (PARTICLE_RADIUS_MAX - PARTICLE_RADIUS_MIN);
   ```
   - ä¼˜å…ˆçº§: ä½

4. **æœªä½¿ç”¨çš„ä¾èµ–**
   - å»ºè®®: æ¸…ç† package.json
   - ä¼˜å…ˆçº§: ä½

---

## ğŸ“š æ¨èå·¥å…·å’Œåº“

### æ€§èƒ½ä¼˜åŒ–
- `@react-three/rapier` - ç‰©ç†å¼•æ“ä¼˜åŒ–
- `use-debounce` - é˜²æŠ–å·¥å…·
- `react-window` - è™šæ‹Ÿåˆ—è¡¨

### ç”¨æˆ·ä½“éªŒ
- `@dnd-kit/core` - æ‹–æ‹½åŠŸèƒ½
- `react-hot-toast` - é€šçŸ¥æç¤º
- `framer-motion` - åŠ¨ç”» (å·²ä½¿ç”¨)

### æ•°æ®å¯è§†åŒ–
- `recharts` - å›¾è¡¨åº“ (å·²ä½¿ç”¨)
- `d3.js` - é«˜çº§å¯è§†åŒ–

### å¼€å‘å·¥å…·
- `lighthouse-ci` - æ€§èƒ½ç›‘æ§
- `bundle-analyzer` - åŒ…å¤§å°åˆ†æ
- `@testing-library/react` - å•å…ƒæµ‹è¯•

---

## âœ… å¿«é€Ÿæ‰§è¡Œæ¸…å•

### ç«‹å³å¯åšçš„ä¼˜åŒ– (1å°æ—¶å†…)

- [ ] å°†ç²’å­æ•°é‡ä» 90000 æ”¹ä¸º 50000
- [ ] æ·»åŠ  loading éª¨æ¶å±
- [ ] ä¿®å¤æ§åˆ¶å°è­¦å‘Š
- [ ] æ·»åŠ  meta æ ‡ç­¾ (SEO)
- [ ] å‹ç¼©å›¾ç‰‡èµ„æº

### æœ¬å‘¨å¯å®Œæˆ (5-10å°æ—¶)

- [ ] å®ç°ç»„ä»¶æ‡’åŠ è½½
- [ ] æ·»åŠ é”™è¯¯è¾¹ç•Œ
- [ ] å®ç°å¿«æ·é”®ç³»ç»Ÿ
- [ ] LocalStorage é˜²æŠ–ä¼˜åŒ–

---

## ğŸ“ æ€»ç»“ä¸å»ºè®®

### æ ¸å¿ƒä¼˜åŒ–å»ºè®®

1. **æ€§èƒ½ä¼˜åŒ–ä¼˜å…ˆ**: å…ˆè§£å†³æ€§èƒ½é—®é¢˜,å†æ·»åŠ æ–°åŠŸèƒ½
2. **æ¸è¿›å¼ä¼˜åŒ–**: ä¸è¦ä¸€æ¬¡æ€§é‡æ„æ‰€æœ‰ä»£ç 
3. **ç›‘æ§ä¸ºç‹**: æ·»åŠ æ€§èƒ½ç›‘æ§,é‡åŒ–ä¼˜åŒ–æ•ˆæœ
4. **ç”¨æˆ·åé¦ˆ**: æ”¶é›†ç”¨æˆ·åé¦ˆ,ä¼˜å…ˆè§£å†³ç—›ç‚¹

### ä¼˜åŒ–ä¼˜å…ˆçº§æ’åº

**ç¬¬ä¸€ä¼˜å…ˆçº§** (æœ¬æœˆå®Œæˆ):
- âœ… ç²’å­ç³»ç»Ÿä¼˜åŒ–
- âœ… ç»„ä»¶æ‡’åŠ è½½
- âœ… é”™è¯¯è¾¹ç•Œ

**ç¬¬äºŒä¼˜å…ˆçº§** (ä¸‹æœˆå®Œæˆ):
- âš¡ å¿«æ·é”®ç³»ç»Ÿ
- âš¡ ä»»åŠ¡æœç´¢ç­›é€‰
- âš¡ æ•°æ®å¯¼å…¥å¯¼å‡º

**ç¬¬ä¸‰ä¼˜å…ˆçº§** (é•¿æœŸè¿­ä»£):
- ğŸ¯ ä¹ æƒ¯è¿½è¸ª
- ğŸ¯ æ•°æ®å¯è§†åŒ–
- ğŸ¯ ç¤¾äº¤åŠŸèƒ½

---

**æœ€åæ›´æ–°**: 2026-01-06
**ä¸‹æ¬¡å¤å®¡**: 1ä¸ªæœˆå

---

## ğŸ‰ ç»“è¯­

LifeRPG æ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„é¡¹ç›®,å·²ç»å…·å¤‡äº†å®Œæ•´çš„åŠŸèƒ½å’Œè‰¯å¥½çš„ä»£ç è´¨é‡ã€‚æœ¬ä¼˜åŒ–æ–¹æ¡ˆæ—¨åœ¨:

1. **æå‡æ€§èƒ½** - è®©åº”ç”¨åœ¨å„ç§è®¾å¤‡ä¸Šéƒ½æµç•…è¿è¡Œ
2. **æ”¹å–„ä½“éªŒ** - è®©ç”¨æˆ·æ›´é«˜æ•ˆåœ°ç®¡ç†ä»»åŠ¡å’Œç›®æ ‡
3. **å¢å¼ºä»·å€¼** - é€šè¿‡æ•°æ®åˆ†æå¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°äº†è§£è‡ªå·±

ä¼˜åŒ–æ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹,å»ºè®®æŒ‰ç…§è·¯çº¿å›¾é€æ­¥æ¨è¿›,å¹¶åœ¨æ¯ä¸ªé˜¶æ®µæ”¶é›†åé¦ˆå’Œæ•°æ®,ä¸æ–­è°ƒæ•´ä¼˜åŒ–æ–¹å‘ã€‚

ç¥é¡¹ç›®è¶Šæ¥è¶Šå¥½! ğŸš€
